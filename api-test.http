### Threads åŠè‡ªå‹•ç™¼æ–‡ç³»çµ± - API æ¸¬è©¦æª”æ¡ˆ
### ä½¿ç”¨ VS Code çš„ REST Client æ“´å……å¥—ä»¶åŸ·è¡Œ
### https://marketplace.visualstudio.com/items?itemName=humao.rest-client

### ====================================
### ç’°å¢ƒè®Šæ•¸è¨­å®š
### ====================================

@baseUrl = http://localhost:3000/api
@token = åœ¨ç™»å…¥å¾Œå°‡tokenè²¼åœ¨é€™è£¡

### ====================================
### 1ï¸âƒ£ ç³»çµ±å¥åº·æª¢æŸ¥ (ç„¡éœ€èªè­‰)
### ====================================

GET {{baseUrl}}/health
Content-Type: application/json

### ====================================
### 2ï¸âƒ£ ä½¿ç”¨è€…èªè­‰
### ====================================

### ç™»å…¥ - å–å¾— JWT Token
POST {{baseUrl}}/auth/login
Content-Type: application/json

{
  "email": "admin@example.com",
  "password": "admin123"
}

### ğŸ‘† åŸ·è¡Œå¾Œ,è¤‡è£½ response ä¸­çš„ "token" å€¼
### ä¸¦è²¼åˆ°ä¸Šæ–¹çš„ @token è®Šæ•¸

### ====================================
### 3ï¸âƒ£ è²¼æ–‡ç®¡ç†
### ====================================

### æŸ¥è©¢æ‰€æœ‰è²¼æ–‡ (å¯åŠ åƒæ•¸)
GET {{baseUrl}}/posts?status=DRAFT&page=1&limit=10
Authorization: Bearer {{token}}

### æŸ¥è©¢å¾…å¯©æ ¸è²¼æ–‡
GET {{baseUrl}}/posts?status=PENDING_REVIEW
Authorization: Bearer {{token}}

### æŸ¥è©¢å·²ç™¼å¸ƒè²¼æ–‡
GET {{baseUrl}}/posts?status=POSTED
Authorization: Bearer {{token}}

### å»ºç«‹æ–°è²¼æ–‡ - ç¯„ä¾‹ 1: AI ç§‘æŠ€ä¸»é¡Œ
POST {{baseUrl}}/posts
Authorization: Bearer {{token}}
Content-Type: application/json

{
  "topic": "äººå·¥æ™ºæ…§çš„æœªä¾†ç™¼å±•",
  "keywords": ["AI", "æ©Ÿå™¨å­¸ç¿’", "æ·±åº¦å­¸ç¿’", "ç¥ç¶“ç¶²è·¯"],
  "targetTone": "å°ˆæ¥­ä½†æ˜“æ‡‚",
  "targetLength": 500,
  "scheduledFor": "2024-12-25T10:00:00Z"
}

### å»ºç«‹æ–°è²¼æ–‡ - ç¯„ä¾‹ 2: ç”Ÿæ´»é¢¨æ ¼
POST {{baseUrl}}/posts
Authorization: Bearer {{token}}
Content-Type: application/json

{
  "topic": "å±…å®¶è¾¦å…¬çš„æ•ˆç‡æå‡ç§˜è¨£",
  "keywords": ["é ç«¯å·¥ä½œ", "æ™‚é–“ç®¡ç†", "å·¥ä½œæ•ˆç‡"],
  "targetTone": "è¼•é¬†è¦ªåˆ‡",
  "targetLength": 300
}

### å»ºç«‹æ–°è²¼æ–‡ - ç¯„ä¾‹ 3: ç§‘æŠ€æ–°è
POST {{baseUrl}}/posts
Authorization: Bearer {{token}}
Content-Type: application/json

{
  "topic": "2024å¹´æœ€å€¼å¾—é—œæ³¨çš„ç§‘æŠ€è¶¨å‹¢",
  "keywords": ["ç§‘æŠ€è¶¨å‹¢", "å‰µæ–°", "æ•¸ä½è½‰å‹"],
  "targetTone": "å°ˆæ¥­åˆ†æ",
  "targetLength": 600,
  "scheduledFor": "2024-12-30T14:00:00Z"
}

### æŸ¥è©¢å–®ä¸€è²¼æ–‡ (è¨˜å¾—æ›¿æ› post_id)
@postId = åœ¨é€™è£¡è²¼ä¸Šè²¼æ–‡ID
GET {{baseUrl}}/posts/{{postId}}
Authorization: Bearer {{token}}

### æ›´æ–°è²¼æ–‡
PATCH {{baseUrl}}/posts/{{postId}}
Authorization: Bearer {{token}}
Content-Type: application/json

{
  "topic": "æ›´æ–°å¾Œçš„ä¸»é¡Œ",
  "keywords": ["æ–°é—œéµå­—"],
  "scheduledFor": "2024-12-26T12:00:00Z"
}

### åˆªé™¤è²¼æ–‡
DELETE {{baseUrl}}/posts/{{postId}}
Authorization: Bearer {{token}}

### ====================================
### 4ï¸âƒ£ å…§å®¹ç”Ÿæˆæµç¨‹
### ====================================

### è§¸ç™¼ AI å…§å®¹ç”Ÿæˆ (è¨˜å¾—æ›¿æ› post_id)
POST {{baseUrl}}/posts/{{postId}}/generate
Authorization: Bearer {{token}}

### ğŸ’¡ åŸ·è¡Œå¾Œç™¼ç”Ÿçš„äº‹:
### 1. åŠ å…¥ç”Ÿæˆä»»å‹™åˆ° Queue
### 2. Worker é–‹å§‹ç”¨ AI (GPT/Gemini) ç”¢ç”Ÿå…§å®¹
### 3. ç”¢ç”Ÿ embedding ä¸¦æª¢æŸ¥èˆ‡éå» 60 ç¯‡çš„ç›¸ä¼¼åº¦
### 4. å¦‚æœç›¸ä¼¼åº¦ < 0.86,ç‹€æ…‹è®Šç‚º PENDING_REVIEW
### 5. ç™¼é€ LINE å¯©ç¨¿é€šçŸ¥çµ¦å¯©æ ¸è€…

### é‡æ–°ç”Ÿæˆå…§å®¹ (å¦‚æœå°ç¾æœ‰å…§å®¹ä¸æ»¿æ„)
POST {{baseUrl}}/posts/{{postId}}/generate
Authorization: Bearer {{token}}
Content-Type: application/json

{
  "regenerate": true
}

### ====================================
### 5ï¸âƒ£ å¯©æ ¸æµç¨‹
### ====================================

### æ ¸å‡†è²¼æ–‡ (è¨˜å¾—æ›¿æ› postId å’Œ revisionId)
@revisionId = åœ¨é€™è£¡è²¼ä¸Šä¿®è¨‚ç‰ˆæœ¬ID
POST {{baseUrl}}/review/approve
Authorization: Bearer {{token}}
Content-Type: application/json

{
  "postId": "{{postId}}",
  "revisionId": "{{revisionId}}",
  "action": "approve"
}

### è¦æ±‚é‡æ–°ç”Ÿæˆ
POST {{baseUrl}}/review/approve
Authorization: Bearer {{token}}
Content-Type: application/json

{
  "postId": "{{postId}}",
  "revisionId": "{{revisionId}}",
  "action": "regenerate"
}

### è·³éæ­¤æ¬¡ç™¼æ–‡
POST {{baseUrl}}/review/approve
Authorization: Bearer {{token}}
Content-Type: application/json

{
  "postId": "{{postId}}",
  "revisionId": "{{revisionId}}",
  "action": "skip"
}

### ====================================
### 6ï¸âƒ£ ç™¼å¸ƒåˆ° Threads
### ====================================

### æ‰‹å‹•è§¸ç™¼ç™¼å¸ƒ (éœ€è¦å…ˆè¨­å®š Threads å¸³è™Ÿ)
POST {{baseUrl}}/posts/{{postId}}/publish
Authorization: Bearer {{token}}

### ğŸ’¡ ç™¼å¸ƒæµç¨‹:
### 1. æª¢æŸ¥è²¼æ–‡ç‹€æ…‹æ˜¯å¦ç‚º APPROVED
### 2. å–å¾— Threads å¸³è™Ÿçš„ access token
### 3. å»ºç«‹ Threads container
### 4. ç™¼å¸ƒ container
### 5. æ›´æ–°è²¼æ–‡ç‹€æ…‹ç‚º POSTED

### ====================================
### 7ï¸âƒ£ Threads OAuth (éœ€è¦ç€è¦½å™¨æ“ä½œ)
### ====================================

### æ­¥é©Ÿ 1: åœ¨ç€è¦½å™¨é–‹å•Ÿæ­¤ URL é€²è¡Œæˆæ¬Š
### https://threads.net/oauth/authorize?client_id=YOUR_CLIENT_ID&redirect_uri=YOUR_REDIRECT_URI&scope=threads_basic,threads_content_publish&response_type=code

### æ­¥é©Ÿ 2: æˆæ¬Šå¾Œæœƒé‡å°å‘å›ä½ çš„ callback URL,ä¸¦å¸¶ä¸Š code åƒæ•¸
### ç³»çµ±æœƒè‡ªå‹•è™•ç† callback ä¸¦å„²å­˜ token

### æŸ¥è©¢ Threads æˆæ¬Šç‹€æ…‹ (éœ€è¦å¯¦ä½œæ­¤ç«¯é»)
# GET {{baseUrl}}/threads/accounts
# Authorization: Bearer {{token}}

### ====================================
### 8ï¸âƒ£ LINE Webhook (ç”± LINE ä¼ºæœå™¨å‘¼å«)
### ====================================

### LINE Webhook ç«¯é» (ç”± LINE ä¼ºæœå™¨ POST)
### åœ¨ LINE Developers Console è¨­å®š:
### Webhook URL: https://your-domain.com/api/line/webhook

### æ¸¬è©¦ LINE Webhook (æ¨¡æ“¬ LINE ä¼ºæœå™¨è«‹æ±‚)
### âš ï¸ éœ€è¦æ­£ç¢ºçš„ LINE signature,å¯¦éš›ä½¿ç”¨ç”± LINE ä¼ºæœå™¨ç™¼é€
POST {{baseUrl}}/line/webhook
Content-Type: application/json
X-Line-Signature: test-signature

{
  "events": [
    {
      "type": "message",
      "replyToken": "test-token",
      "source": {
        "userId": "U1234567890abcdef"
      },
      "message": {
        "type": "text",
        "text": "æ¸¬è©¦è¨Šæ¯"
      }
    }
  ]
}

### ====================================
### 9ï¸âƒ£ é€²éšæŸ¥è©¢ç¯„ä¾‹
### ====================================

### æŸ¥è©¢ç‰¹å®šæ—¥æœŸç¯„åœçš„è²¼æ–‡
GET {{baseUrl}}/posts?startDate=2024-12-01&endDate=2024-12-31
Authorization: Bearer {{token}}

### æŸ¥è©¢ç‰¹å®šä¸»é¡Œçš„è²¼æ–‡
GET {{baseUrl}}/posts?topic=AI
Authorization: Bearer {{token}}

### åˆ†é æŸ¥è©¢
GET {{baseUrl}}/posts?page=2&limit=20
Authorization: Bearer {{token}}

### çµ„åˆæŸ¥è©¢
GET {{baseUrl}}/posts?status=POSTED&page=1&limit=10&sortBy=createdAt&order=desc
Authorization: Bearer {{token}}

### ====================================
### ğŸ”Ÿ å®Œæ•´æ¸¬è©¦æµç¨‹
### ====================================

### æ­¥é©Ÿç¸½è¦½:
### 1. âœ… å¥åº·æª¢æŸ¥
### 2. âœ… ç™»å…¥å–å¾— Token
### 3. âœ… å»ºç«‹è²¼æ–‡
### 4. âœ… è§¸ç™¼å…§å®¹ç”Ÿæˆ
### 5. â³ ç­‰å¾… Worker è™•ç† (10-30ç§’)
### 6. âœ… æŸ¥è©¢è²¼æ–‡ç‹€æ…‹ (æ‡‰ç‚º PENDING_REVIEW)
### 7. âœ… æ ¸å‡†è²¼æ–‡
### 8. âœ… ç™¼å¸ƒåˆ° Threads (éœ€å…ˆè¨­å®š Threads å¸³è™Ÿ)
### 9. âœ… æŸ¥è©¢æœ€çµ‚ç‹€æ…‹ (æ‡‰ç‚º POSTED)

### ====================================
### ğŸ“Š é™¤éŒ¯å·¥å…·
### ====================================

### å¦‚æœé‡åˆ°å•é¡Œ,æª¢æŸ¥:
### 1. æ—¥èªŒæª”æ¡ˆ: logs/all.log, logs/error.log
### 2. MySQL è³‡æ–™åº«:
###    - posts è¡¨: è²¼æ–‡è³‡æ–™
###    - post_revisions è¡¨: å…§å®¹ç‰ˆæœ¬
###    - review_requests è¡¨: å¯©æ ¸è«‹æ±‚
###    - jobs è¡¨: ä»»å‹™ç‹€æ…‹
### 3. Redis Queue: ä½¿ç”¨ Redis CLI æˆ– BullMQ Board
### 4. Worker é‹è¡Œç‹€æ…‹: æª¢æŸ¥ worker çµ‚ç«¯æ©Ÿè¼¸å‡º

### ====================================
### ğŸ’¡ æç¤º
### ====================================

### 1. é¦–æ¬¡ä½¿ç”¨è«‹å…ˆåŸ·è¡Œã€Œç™»å…¥ã€å–å¾— token
### 2. å°‡ token è²¼åˆ°æª”æ¡ˆé–‹é ­çš„ @token è®Šæ•¸
### 3. å»ºç«‹è²¼æ–‡å¾Œ,å°‡ id è²¼åˆ° @postId è®Šæ•¸
### 4. è§¸ç™¼ç”Ÿæˆå¾Œ,ç­‰å¾… 10-30 ç§’å†æŸ¥è©¢ç‹€æ…‹
### 5. æŸ¥çœ‹ response ä¸­çš„ latestRevision.id,è²¼åˆ° @revisionId
### 6. è¨˜å¾—å…ˆåœ¨ MySQL æ›´æ–°ç®¡ç†å“¡çš„ line_user_id
### 7. éœ€è¦è‡³å°‘ä¸€å€‹ AI API Key (OpenAI æˆ– Gemini)

### ====================================
### ğŸš€ é–‹å§‹æ¸¬è©¦!
### ====================================
